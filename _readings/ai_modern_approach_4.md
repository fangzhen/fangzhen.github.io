---
layout: post
title: 读书笔记 - 人工智能：现代方法，第四部分：不确定知识和不确定推理
date: 2025-03-26
tags: AI
---

## 第12章总结：量化不确定性

本章探讨了如何在不确定环境中进行理性决策，重点介绍了概率论作为量化不确定性的基本工具，以及如何将其应用于人工智能中的推理和决策问题。

### **不确定性与理性决策**
- 现实中的智能体常面临不确定性（如部分可观测性、非确定性或对抗环境）。
- 逻辑智能体通过信念状态和应急计划处理不确定性，但这种方法在复杂场景下效率低下（需考虑所有可能性）。
- **最大期望效用（MEU）原则**：理性决策应选择能最大化期望效用的行动，结合概率和效用理论（决策理论）。

### **概率论基础**
- **概率模型**：可能世界的概率分布，满足概率公理（非负性、归一性、可加性）。
- **联合概率分布**：完整描述所有变量组合的概率，但实际应用中因规模过大难以直接使用。
- **条件概率与独立性**：
  - 条件概率公式：$P(a \mid b) = \frac{P(a \land b)}{P(b)}$。
  - 独立性简化计算（如天气与牙科问题独立）。

### **贝叶斯规则及其应用**
- **贝叶斯规则**：$P(b \mid a) = \frac{P(a \mid b)P(b)}{P(a)}$，用于从因果概率推导诊断概率（如从症状推断疾病）。
- **条件独立性**：给定原因变量，多个效应变量独立（如牙痛和探针卡住给定龋齿状态独立），显著减少计算复杂度。

### **朴素贝叶斯模型**
- 假设所有效应变量在给定原因下条件独立，简化联合分布为：
     $P(\text{Cause}, \text{Effect}_1, \ldots, \text{Effect}_n) = P(\text{Cause}) \prod_i P(\text{Effect}_i \mid \text{Cause})$。
- 应用示例：文本分类（如新闻类别判断），尽管独立性假设常不成立，实际效果仍较好。

### **Wumpus世界的概率推理**
- 通过概率模型处理部分可观测性（如方格是否有陷阱）。
- 利用条件独立性分解联合分布，避免枚举所有可能世界，高效计算后验概率（如[1,3]方格有陷阱的概率为31%）。

## 第13章总结：概率推理
模型概述：静态世界的背景下的概率推理技术

### 1. **贝叶斯网络**
- **定义**：贝叶斯网络是一种有向无环图（DAG），节点表示随机变量，边表示变量间的依赖关系，每个节点附带条件概率表（CPT）。
- **特点**：
  - 通过条件独立性简化联合概率表示。
  - 因果关系的直观表达（如“火灾导致烟雾”）。
- **构建方法**：按拓扑顺序选择变量，基于父节点确定条件概率。

### 2. **精确推理**
- **枚举法**：直接计算联合概率，复杂度高（指数级）。
- **变量消除法**：动态规划思想，逐步求和消除变量，减少重复计算。
- **复杂度**：
  - 单连通网络（如树结构）：线性时间。
  - 多连通网络：NP难问题，精确推理困难。

### 3. **近似推理**
- **直接采样**：
  - **拒绝采样**：生成样本后丢弃不符合证据的样本，效率低。
  - **似然加权**：对符合证据的样本加权，提高效率。
- **马尔可夫链蒙特卡洛（MCMC）**：
  - **吉布斯采样**：基于马尔可夫链，逐步更新变量值，收敛到后验分布。
  - **Metropolis-Hastings**：通过提议分布和接受概率生成样本，适用更广。

### 4. **因果网络**
- **特点**：明确区分因果关系与概率依赖，支持干预分析（如`do`算子）。
- **应用**：预测干预效果（如“打开洒水器对草地湿度的影响”），避免反向因果误判。

### 5. **实际应用与挑战**
- **优势**：
  - 紧凑表示高维概率分布。
  - 结合领域知识构建网络（如医疗诊断、基因分析）。
- **挑战**：
  - 精确推理在大规模网络中不可行。
  - 近似方法需权衡精度与效率。

### 6. **扩展与工具**
- **混合网络**：结合离散与连续变量（如线性高斯模型）。
- **工具**：HUGIN、STAN等系统支持高效推理。

本章为不确定性问题提供了系统化的建模与推理方法，为后续学习（如第18章的扩展模型）奠定基础。

## **第14章总结：时间上的概率推理**

### **核心主题**
本章探讨了在部分可观察环境中，智能体如何利用概率推理跟踪当前状态、预测未来状态以及理解过去状态。重点在于处理不确定性，并通过概率理论量化信念状态。

### **关键概念**
1. **时间与不确定性**
   - **离散时间模型**：将时间划分为切片，每个切片包含状态变量（不可观察）和证据变量（可观察）。
   - **马尔可夫假设**：当前状态仅依赖于有限的历史状态（如一阶马尔可夫过程仅依赖前一状态）。
   - **转移模型与传感器模型**：分别描述状态演变和观测生成的概率分布。

2. **动态模型类型**
   - **隐马尔可夫模型（HMM）**：状态是离散的单一变量，适用于简单序列建模（如语音识别）。
   - **卡尔曼滤波器**：状态是连续变量，假设线性高斯模型，适用于物理运动跟踪（如机器人定位）。
   - **动态贝叶斯网络（DBN）**：通用框架，可表示复杂状态变量和依赖关系，支持混合离散与连续变量。

3. **推理任务**
   - **滤波（状态估计）**：计算当前状态的后验分布 $P(X_t \vert e_{1:t})$。
   - **预测**：计算未来状态的后验分布 $P(X_{t+k} \vert e_{1:t})$。
   - **平滑**：计算过去状态的后验分布 $P(X_k \vert e_{1:t})$（$k < t$）。
   - **最可能解释**：找到最可能生成观测序列的状态序列。

4. **算法与优化**
   - **前向-后向算法**：用于HMM的精确推理，计算滤波和平滑。
   - **维特比算法**：寻找最可能状态序列，时间复杂度线性于序列长度。
   - **粒子滤波**：通过采样近似处理非线性/非高斯模型，适用于高维状态空间（如SLAM问题）。
   - **Rao-Blackwell化**：结合精确推理与采样，提升效率（如分离定位与建图变量）。

5. **挑战与解决方案**
   - **计算复杂性**：精确推理在高维状态空间不可行，需依赖近似方法（如粒子滤波）。
   - **传感器故障**：通过瞬态/持久故障模型改进鲁棒性。
   - **静态变量处理**：如Rao-Blackwell化或混合方法（粒子MCMC）。

### **应用场景**
- **隐马尔可夫模型**：语音识别、基因序列分析。
- **卡尔曼滤波**：目标跟踪、导航系统。
- **动态贝叶斯网络**：复杂系统建模（如交通预测、多机器人协作）。
- **粒子滤波**：机器人定位、视觉目标跟踪。

### **总结**
本章系统介绍了时序概率模型的理论与算法，从基础的HMM和卡尔曼滤波到通用的DBN和粒子滤波，强调了在不确定性下进行状态估计和预测的方法。通过近似算法和模型优化（如Rao-Blackwell化），解决了高维和复杂系统的推理难题，为实际应用（如自动驾驶、医疗诊断）提供了理论基础。
